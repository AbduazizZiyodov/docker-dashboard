<p-toast position="bottom-left"></p-toast>

<div class="card m-5" *ngIf="!containers.length">
  <div class="text-center">
    <img
      src="assets/images/confused.jpg"
      style="border-radius: 5%"
      width="30%"
      alt=""
    />
    <h2>Containers?</h2>
    <br />
    <strong> You can try this in your command line: </strong> <br />
    <code style="font-family: 'Fira Mono'">docker run hello-world</code>
    <p-divider align="center">Or</p-divider>
    <p-button
      label="New"
      icon="fa-solid fa-plus"
      size="small"
      severity="success"
      [routerLink]="['new']"
    ></p-button>
  </div>
</div>

<div class="card m-2" *ngIf="containers.length">
  <h2>
    Containers
    <p-button
      label="New"
      icon="fa-solid fa-plus"
      size="small"
      severity="success"
      [routerLink]="['new']"
    ></p-button>
  </h2>

  <p-table
    class="shadow-1"
    [rows]="5"
    [value]="containers"
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 20]"
    [loading]="isLoading"
  >
    <ng-template pTemplate="caption">
      <div class="flex">
        <p-columnFilter
          type="text"
          field="name"
          placeholder="Search by name"
          ariaLabel="Filter Name"
        />

        <p-columnFilter
          type="text"
          field="short_id"
          placeholder="Search by Id"
          ariaLabel="Filter Short Id"
        />

        <p-columnFilter
        type="text"
        field="image.name"
        placeholder="Search by Image Name"
        ariaLabel="Filter Image Name"
      />

        <p-columnFilter field="status" matchMode="equals" [showMenu]="false">
          <ng-template pTemplate="filter" let-value let-filter="filterCallback">
            <p-dropdown
              [(ngModel)]="val"
              [options]="statuses"
              (onChange)="filter($event.value)"
              placeholder="Select One"
              [showClear]="true"
            >
              <ng-template let-option pTemplate="item">
                <p-tag
                  [value]="option.label"
                  [severity]="getContainerStatus(option.value)"
                />
              </ng-template>
            </p-dropdown>
          </ng-template>
        </p-columnFilter>
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name">
          <div class="flex align-items-center">
            Name <p-sortIcon field="name"></p-sortIcon>
          </div>
        </th>
        <th pSortableColumn="id">Id <p-sortIcon field="id"></p-sortIcon></th>
        <th>State</th>
        <th pSortableColumn="image.name">
          Image <p-sortIcon field="image.name"></p-sortIcon>
        </th>
        
        <th>
          Created
          <p-sortIcon field="id"></p-sortIcon>
        </th>
        <th>Quick Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-container let-columns="columns">
      <tr>
        <td>
          <p-button
            [outlined]="true"
            [label]="container.name"
            severity="help"
          ></p-button>
        </td>
        <td>
          <p-button
            [size]="'small'"
            [label]="container.short_id"
            severity="info"
            (click)="copyContainerId(container.short_id)"
          ></p-button>
        </td>
        <td>
          <p-button
            [outlined]="true"
            [size]="'small'"
            [label]="container.status.toUpperCase()"
            [severity]="getContainerStatus(container.status)"
          ></p-button>
        </td>
        <td>
          <strong>
            {{ container.image.name + ":" + container.image.tag }}
          </strong>
        </td>
        
        <td>
          {{ container.created | date: 'dd/MM/yyyy hh:mm a'}}
        </td>
        <td>
          <p-button
            severity="success"
            size="small"
            *ngIf="container.status != 'running'"
            class="m-1"
            icon="fa-solid fa-play"
            (onClick)="containerAction(container, 'start')"
          >
          </p-button>

          <p-button
            size="small"
            severity="help"
            *ngIf="container.status == 'running'"
            class="m-1"
            icon="fa-solid fa-pause"
            (onClick)="containerAction(container, 'pause')"
          ></p-button>

          <p-button
            severity="danger"
            *ngIf="container.status == 'running'"
            class="m-1"
            size="small"
            icon="fa-solid fa-stop"
            (onClick)="containerAction(container, 'stop')"
          >
          </p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
