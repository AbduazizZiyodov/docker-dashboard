<p-toast position="bottom-right"></p-toast>

<div class="card m-5" *ngIf="!containers.length">
  <div class="text-center">
    <h2>Containers?</h2>
    <img
      src="assets/images/confused.jpg"
      style="border-radius: 5%"
      width="30%"
      alt=""
    />
    <p-divider></p-divider>
    <strong> You can try this in your command line: </strong> <br />
    <code style="font-family: 'Fira Mono'">docker run hello-world</code>
  </div>
</div>

<div class="card m-5" *ngIf="containers.length">
  <h2>
    <i class="fa-solid fa-cube" style="color: #4ade80"></i> Container List
  </h2>
  <p-table
    [rows]="5"
    [value]="containers"
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 20]"
    [loading]="isLoading"
  >
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th pSortableColumn="id">Id <p-sortIcon field="id"></p-sortIcon></th>
        <th pSortableColumn="name">
          Name <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th>State</th>
        <th pSortableColumn="image.name">
          Image <p-sortIcon field="image.name"></p-sortIcon>
        </th>

        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-container let-columns="columns">
      <tr>
        <td>
          <p-button
            [size]="'small'"
            [label]="container.short_id"
            severity="info"
          ></p-button>
        </td>
        <td>
          <p-button
            [outlined]="true"
            [label]="container.name"
            severity="help"
          ></p-button>
        </td>
        <td>
          <p-button
            [outlined]="true"
            [size]="'small'"
            [label]="container.status.toUpperCase()"
            [severity]="getContainerStatus(container.status)"
          ></p-button>
        </td>
        <td>
          <strong>
            {{ container.image.name + ":" + container.image.tag }}
          </strong>
        </td>

        <td>
          <p-button
            severity="success"
            size="small"
            *ngIf="container.status != 'running'"
            class="m-1"
            (onClick)="startContainer(container)"
          >
            <i class="fa-solid fa-play"></i>
          </p-button>

          <p-button
            size="small"
            severity="help"
            *ngIf="container.status == 'running'"
            class="m-1"
            (onClick)="pauseContainer(container)"
            ><i class="fa-solid fa-pause"></i
          ></p-button>

          <p-button
            severity="danger"
            *ngIf="container.status == 'running'"
            class="m-1"
            size="small"
            (onClick)="stopContainer(container)"
          >
            <i class="fa-solid fa-stop"></i
          ></p-button>

          <p-button
            severity="danger"
            *ngIf="container.status == 'running'"
            class="m-1"
            size="small"
            (onClick)="openContainerKillDialog(container)"
          >
            <i class="fa-solid fa-skull-crossbones"></i>
          </p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  header="Are you sure?"
  [visible]="isVisible"
  [draggable]="false"
  [resizable]="false"
>
  <p class="m-0">
    You are trying to kill container {{ selectedContainer }}, continue? <br />
    If so, please select signal code:
    <p-dropdown
      [options]="signalOptions"
      [(ngModel)]="selectedSignal"
      optionLabel="name"
      optionValue="code"
      placeholder="Select a Signal"
    ></p-dropdown>
  </p>

  <p-divider></p-divider>

  <p-button severity="danger" class="m-1" (onClick)="killContainer()">
    <i class="fa-solid fa-gun m-1"></i> Kill</p-button
  >
  <p-button severity="success" class="m-1" (onClick)="isVisible = false">
    <i class="fa-regular fa-circle-xmark m-1"></i> No</p-button
  >
</p-dialog>
